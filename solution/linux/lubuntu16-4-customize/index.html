<!--
佛说：众生皆苦。
须菩提，忍辱波罗密，如来说非忍辱波罗密，是名忍辱波罗密。
过去心不可得，现在心不可得，未来心不可得

开经偈：
无上甚深微妙法，百千万劫难遭遇。
我今见闻得受持，愿解如来真实义。     
-->

<!DOCTYPE html>
<html lang="zh-CN,en,default">

<head><meta name="generator" content="Hexo 3.9.0"><link rel="manifest" href="/manifest.json">
  
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="renderer" content="webkit">
  <meta name="author" content="CST研习舍">
  <meta name="theme-color" content="#2f3241">
<title>Lubuntu16.4.3定制教程 | CST研习舍</title>
<meta name="description" content="Lubuntu16.4.3定制教程
迟思堂工作室

本文是对 lubuntu-16.04.3-desktop-amd64.iso 进行定制文档，最终输出一个可以烧写到 U 盘并能启动的 ISO 镜像文件。本文要求读者对 linux 有一定掌握程度，比如：知道用户权限（root 权限）、知道如何使用 apt-get install 安装软件，知道 shell。本文注重的是制作的方法，另外有做好的定制脚本文件，具体参考工程仓库内文件。工程仓库里的图标、配置文件显示的字符串可能与本文有出入，最终以读者自行判断的为准。">
<meta name="keywords" content="开源,迟思堂,迟思堂工作室,CST工作室,CST研习舍">

  <base href="/">
  <link rel="shortcut icon" href="image/favicon.ico">
  <link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.7.2/css/all.min.css">
  <link rel="stylesheet" href="https://lib.baomitu.com/highlight.js/9.15.10/styles/dark.min.css">
  <link rel="stylesheet" href="library/index.css">
  <link rel="stylesheet" href="common.css">
  <style>
    .site-header-nav-item a:link {
      text-decoration: none;
    }
  </style>
  <script src="https://lib.baomitu.com/jquery/3.4.1/jquery.slim.min.js"></script>
  <script src="https://lib.baomitu.com/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <script src="https://lib.baomitu.com/highlight.js/9.15.10/highlight.min.js"></script>
  <script src="common.js" defer async></script>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <a class="site-header-logo no-underline-hover" href="."> <!-- 网站logo -->
        <img class="site-header-icon" src="image/logo.png">
        CST研习舍</a>
      <nav class="site-header-nav"><!-- 标题导航 -->
        
          <div class="site-header-nav-item">
            
              <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="Nav_0" href data-href-match>
                资讯
              </a>
              <div class="dropdown-menu" aria-labelledby="Nav_0">
                
                  <a class="dropdown-item" href="/categories/Activity/">活动</a>
                
              </div>
            
          </div>
        
          <div class="site-header-nav-item">
            
              <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="Nav_1" href data-href-match>
                资源
              </a>
              <div class="dropdown-menu" aria-labelledby="Nav_1">
                
                  <a class="dropdown-item" href="/categories/Document">文档</a>
                
                  <a class="dropdown-item" href="/categories/Manual">手册</a>
                
              </div>
            
          </div>
        
          <div class="site-header-nav-item">
            
              <a role="button" href="/categories/Solution/" data-href-match>
                案例
              </a>
            
          </div>
        
          <div class="site-header-nav-item">
            
              <a role="button" href="/book" data-href-match>
                书籍
              </a>
            
          </div>
        
          <div class="site-header-nav-item">
            
              <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="Nav_4" href data-href-match>
                关于
              </a>
              <div class="dropdown-menu" aria-labelledby="Nav_4">
                
                  <a class="dropdown-item" href="/profile/license">版权声明</a>
                
                  <a class="dropdown-item" href="/profile/contact">联系我们</a>
                
                  <a class="dropdown-item" href="/profile/about">关于</a>
                
              </div>
            
          </div>
         <!-- 导航结束 -->
        <form action="search/" class="ais-search-box"> <!-- 搜索 -->
          <input type="search" name="keyword" required placeholder="搜索" id="search-input" class="nav-search ais-search-box--input" aria-label="search-box" autocapitalize="off" autocorrect="off" role="textbox">
        </form>
        <a class="site-header-nav-item octicon" href="https://github.com/CSTStudio/" title="Github Organization">
          <span class="mega-octicon octicon-mark-github vertical-middle"></span>
        </a>
      </nav>
    </div>
  </header>
  <style>
  .blog-post hr:first-of-type {
    display: block;
  }
</style>



<section class="page-section blog-post">
  <div class="container">
    <h1>Lubuntu16.4.3定制教程</h1>

    

    

<div class="blog-byline mt-2 mb-4 d-flex justify-content-between align-items-center">

<!-- 暂时不显示时间和作者信息 -->
  <span class="blog-index-time">2018-04-19 14:01:05</span>



  <span>
    
      <a class="badge badge-primary" href="categories/Solution/">
        Solution
      </a>
    
      <a class="badge badge-primary" href="categories/Solution/Linux/">
        Linux
      </a>
    
    
  </span>
</div>


    

    <!-- <details>
      <summary>正文大纲</summary>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">Lubuntu16.4.3定制教程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1、环境搭建"><span class="toc-text">1、环境搭建</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2、文件说明"><span class="toc-text">2、文件说明</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3、制作步骤"><span class="toc-text">3、制作步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4、定制过程"><span class="toc-text">4、定制过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-桌面背景图片"><span class="toc-text">4.1 桌面背景图片</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-背景图片"><span class="toc-text">4.1.1 背景图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-菜单的-logo-图"><span class="toc-text">4.1.2 菜单的 logo 图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-系统关机显示的图标"><span class="toc-text">4.2 系统关机显示的图标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-开机文字和图片"><span class="toc-text">4.3 开机文字和图片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-修改终端效果"><span class="toc-text">4.4 修改终端效果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-修改鼠标样式"><span class="toc-text">4.5 修改鼠标样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-修改桌面图标"><span class="toc-text">4.6 修改桌面图标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-放置图标快捷到桌面"><span class="toc-text">4.7 放置图标快捷到桌面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-8-新加-home-目录和根目录到桌面"><span class="toc-text">4.8 新加 home 目录和根目录到桌面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-9-新加锁屏"><span class="toc-text">4.9 新加锁屏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-10-启动菜单添加新图标"><span class="toc-text">4.10 启动菜单添加新图标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-11-启动菜单添加新分类"><span class="toc-text">4.11 启动菜单添加新分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-12-添加用户：普通用户-latelee"><span class="toc-text">4.12 添加用户：普通用户 latelee</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-13-添加用户：root-用户"><span class="toc-text">4.13 添加用户：root 用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-14-修改主题、鼠标样式"><span class="toc-text">4.14 修改主题、鼠标样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-15-修改时区"><span class="toc-text">4.15 修改时区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-16-添加环境变量"><span class="toc-text">4.16 添加环境变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-17-系统汉化"><span class="toc-text">4.17 系统汉化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-18-语言文件修改"><span class="toc-text">4.18 语言文件修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-19-添加拼音、五笔输入法"><span class="toc-text">4.19 添加拼音、五笔输入法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-20-删除软件安装途径"><span class="toc-text">4.20 删除软件安装途径</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5、最终定制效果及-ISO-下载"><span class="toc-text">5、最终定制效果及 ISO 下载</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6、免责声明"><span class="toc-text">6、免责声明</span></a></li></ol>
    </details> -->

    <main><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><center><h1>Lubuntu16.4.3定制教程</h1></center>
<center>迟思堂工作室</center>

<p>本文是对 lubuntu-16.04.3-desktop-amd64.iso 进行定制文档，最终输出一个可以烧写到 U 盘并能启动的 ISO 镜像文件。本文要求读者对 linux 有一定掌握程度，比如：知道用户权限（root 权限）、知道如何使用 apt-get install 安装软件，知道 shell。本文注重的是制作的方法，另外有做好的定制脚本文件，具体参考工程仓库内文件。工程仓库里的图标、配置文件显示的字符串可能与本文有出入，最终以读者自行判断的为准。</p>
<a id="more"></a>

<p>如无特殊说明：<br>本文提到的命令，都是用 root 执行的。<br>本文所述“启动系统”、“重启系统”、“ISO 启动”等，都是指“启动 iso，进入 livecd 环境”。<br>本文假定读者能自由切换 sudo 和 root，并能自由切换“/”和“\”。<br>本文工程项目仓库地址：<a href="https://github.com/cststudio/lubuntucd" target="_blank" rel="noopener">https://github.com/cststudio/lubuntucd</a> ，下文将其为“工程”或“工程仓库”。</p>
<h1 id="1、环境搭建"><a href="#1、环境搭建" class="headerlink" title="1、环境搭建"></a>1、环境搭建</h1><p>制作 iso 镜像，需要使用一台 linux 系统，可以是物理机，也可以是虚拟机，只要保证安装有相应的工具即可。本文使用的系统是 12 核至强处理器，64GB 内存的 ubuntu 16.04 64bit。CPU 核心数越多，制作 ISO 镜像越快（本文所用系统制作 ISO 耗时大约 1 分钟左右）。<br>就制作过程而言，需要使用的工具安装步骤如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install squashfs-tools</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install mkisofs</span><br><span class="line">sudo apt install xorriso</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install isolinux</span><br></pre></td></tr></table></figure>

<p>说明：<br>squashfs-tools 主要用于解压、压缩 squash 文件系统的（ISO 光盘使用这种格式）。<br>mkisofs 和 xorriso 主要用于制定 ISO 镜像文件。<br>isolinux 主要用于生成 isohdpfx.bin。安装该工具后，在/usr/lib/ISOLINUX/下面会有 isohdpfx.bin，这个文件是我们在制定 ISO 时使用到的，需要将其拷贝到指定目录。该文件已经整合到工程仓库里了。</p>
<h1 id="2、文件说明"><a href="#2、文件说明" class="headerlink" title="2、文件说明"></a>2、文件说明</h1><p>制作过程需要使用大量命令，为了简化其人工输入的失误，因此，在解压 ISO、制作 ISO 过程中，均使用脚本来实现。<br>本文工程使用的主要文件和目录说明如下：</p>
<ul>
<li>1_tar_iso.sh：解压专用。用于将原始 ISO（即从官网下载的镜像）解压，得到 rootfs 文件。</li>
<li>2_tar_splash.sh ：解压 splash、bootlogo 相关文件。</li>
<li>3_build_splash.sh：：更新并重新制作 splash、bootlogo 相关文件。</li>
<li><code>update.sh</code>：更新 ISO 镜像（即本文的定制部分将通过此脚本完成，当然也可以手工一步步完成）。</li>
<li>4_build_iso.sh：制作 ISO 镜像专用。用于将修改后 rootfs 打包、制作成新的 ISO 镜像。</li>
<li>work：工作目录，包括自定义图片、修改后的配置文件、语言文件、isohdpfx.bin 文件，等等。<br>细节请自行查阅文件。</li>
</ul>
<h1 id="3、制作步骤"><a href="#3、制作步骤" class="headerlink" title="3、制作步骤"></a>3、制作步骤</h1><p>一般来说，制作过程分几个阶段：</p>
<ol>
<li>下载镜像文件 lubuntu-16.04.3-desktop-amd64.iso，将这个镜像文件和脚本文件（1_tar_iso.sh、2_tar_splash.sh 等)放置同一个目录。</li>
<li>解压原始镜像文件。此阶段使用 1_tar_iso.sh 脚本进行（注意：后面我们定制时，是基于已经解压的 iso 文件，因此，这个阶段就不再需要了）。执行脚本：</li>
</ol>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">./1_tar_iso.sh</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>自定义制作。此阶段根据实际情况不同而不同。文后主要在此阶段进行说明、演示。</li>
<li>重新制作 ISO 镜像。此阶段使用 4_build_iso.sh 脚本进行。执行脚本：</li>
</ol>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">./</span> 4_build_iso.sh</span><br></pre></td></tr></table></figure>

<p>测试我们重新制定的 ISO 有 2 种方式。第一种是使用虚拟机 vmware 软件，新建一个虚拟机，然后使用新生成的 iso，启动即可看到效果。这种方法在初期阶段建议，因为比较快看到效果。第二种是使用烧写工具将 ISO 烧写到 U 盘，从 U 盘启动，查看效果。烧写工具因系统不同而不同，这里介绍的是在 Linux 系统中烧写方式。<br>将 U 盘插入计算机的 USB 口，使用</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> <span class="string">/dev/sd</span>*</span><br></pre></td></tr></table></figure>

<p>查看。一般来说，只有一块硬盘的计算机，/dev/sda 即为该硬盘的设备文件（盘符），而/dev/sdb 就是 U 盘的设备文件。简单记忆就是 sda 表示系统识别到的第一块磁盘，sdb 是第二块，sdc 为第三块，等等。本文使用的系统有 2 块硬盘，因此 U 盘的设备文件为/dev/sdc。烧写命令如：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="attribute">if</span>=lubuntu-16.04.3-desktop-amd64.iso <span class="attribute">of</span>=/dev/sdc</span><br></pre></td></tr></table></figure>

<p>其中 if 表示要烧写的镜像文件，这里是 lubuntu-16.04.3-desktop-amd64.iso，of 表示要烧写的 U 盘设备文件。</p>
<h1 id="4、定制过程"><a href="#4、定制过程" class="headerlink" title="4、定制过程"></a>4、定制过程</h1><p>为了行文简便，本节定制过程，仅仅是描述要定制的流程，不重复涉及解压 iso、重新制定 iso 的过程，请参考第三章节。凡是演示有效果图的，均是重新制作 ISO，然后再启动 ISO 系统。<br>本文定制的镜像、脚本，统一放到/home/latelee/iso 目录。ISO 真正内容位于 squashfs-root 目录。该目录由脚本固定，本文使用该目录来描述，如果实际目录不同，目录名跟着变化即可。本节涉及路径都在/home/latelee/iso 目录下面，比如</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">squashfs-root<span class="regexp">/usr/</span>share<span class="regexp">/lubuntu/</span>wallpapers</span><br></pre></td></tr></table></figure>

<p>实际在系统的全路径为：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/home/</span>latelee<span class="regexp">/iso/</span>squashfs-root<span class="regexp">/usr/</span>share<span class="regexp">/lubuntu/</span>wallpapers</span><br></pre></td></tr></table></figure>

<p>为了编写高效，有时会使用 windows 系统，比如存放图片、修改图片等等，会使用“\”分隔符，在本文中，不区别对待“/”和“\”，在真正操作时，请时刻记住在 linux 下是“/”的。<br>实践小结：<br>建议部分重要文件使用 chroot 进入 squashfs-root 来编辑。<br>比如 ISO 光盘中的/usr/share/plymouth/themes/lubuntu-text/lubuntu-text.plymouth 文件，是链接到/etc/alternatives/text.plymouth 的。<br>如果在主机上查看/etc/alternatives/text.plymouth，该文件却链接到/usr/share/plymouth/themes/xubuntu-text/xubuntu-text.plymouth。<br>因为本文是使用 ubuntu 来定制 lubuntu，所以会出现这种情况。如果主机也是 lubuntu，则不会这样。但是，如果不小心改错了 ISO 里面的文件，还是会影响主机的使用的。<br>下图是默认的 lubuntu 桌面：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_lubuntu_org_desktop.png">

<h2 id="4-1-桌面背景图片"><a href="#4-1-桌面背景图片" class="headerlink" title="4.1 桌面背景图片"></a>4.1 桌面背景图片</h2><h3 id="4-1-1-背景图片"><a href="#4-1-1-背景图片" class="headerlink" title="4.1.1 背景图片"></a>4.1.1 背景图片</h3><p>目录：squashfs-root \usr\share\lubuntu\wallpapers<br>默认是图片名称：lubuntu-default-wallpaper.png<br>分辨率：2560X1600<br>【定制】：<br>将自己喜欢的图片（最好保持分辨率），放到此目录，并修改为 lubuntu-default-wallpaper.png。原来的图片可以删除可重命名。</p>
<h3 id="4-1-2-菜单的-logo-图"><a href="#4-1-2-菜单的-logo-图" class="headerlink" title="4.1.2 菜单的 logo 图"></a>4.1.2 菜单的 logo 图</h3><p>目录：squashfs-root \usr\share\lubuntu\images<br>默认名称：1604-lubuntu-logo.png<br>分辨率：56x24<br>【定制】：<br>将自己喜欢的图片（最终保持分辨率），放到此目录，并修改为 1604-lubuntu-logo.png。原来的图片可以删除可重命名。<br>注：squashfs-root \usr\share\lubuntu\images 目录下的 1604-logout-banner.png 是登出显示的 logo 图片。<br>定制效果如下图所示：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_background.png">

<h2 id="4-2-系统关机显示的图标"><a href="#4-2-系统关机显示的图标" class="headerlink" title="4.2 系统关机显示的图标"></a>4.2 系统关机显示的图标</h2><p>目录：squashfs-root\usr\share\plymouth\themes\lubuntu-logo<br>文件：lubuntu_logo.png<br>分辨率：217X58<br>直接替换该文件即可。</p>
<h2 id="4-3-开机文字和图片"><a href="#4-3-开机文字和图片" class="headerlink" title="4.3 开机文字和图片"></a>4.3 开机文字和图片</h2><p>开机文字和图片是 livecd 启动正式系统前进行显示的。内容位于 newiso 目录。<br>开机文字涉及目录：newiso\isolinux<br>开机图片涉及文件：newiso\casper\initrd.lz<br>修改过程十分复杂，已经制作成脚本，参考 2_tar_splash.sh 和 3_build_splash.sh。修改的图片、文件放到 work\splash 目录。下面介绍有关文件：<br>en.tr、txt.cfg、zh_CN.tr、zh_TW.tr：开机文字文件(.tr 文件部分为二进制，部分为正常字符串，笔者使用 notepad++对正常字符串进行修改)，需要将修改后的文件放到 newiso\isolinux 目录，同时也要重新制定该目录的 bootlogo 文件。<br>splash.pcx：开机选择安装系统时显示的图片，pcx 格式（用 photoshop 可修改、保存。注：相同分辨率，大小不同，开机图片会显示不正常，暂未知原因）。放到 newiso\isolinux 目录，同时也要重新制定该目录的 bootlogo 文件。<br>lubuntu_logo.png、progress_dot_on.png：系统启动过程显示的图片。需要重新制作，最后生成 initrd.lz 文件。<br>就本节实验而言，修改的地方有：<br>en.tr 文件中，将</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Install</span> Lubuntu</span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Install</span> Lubuntu-KXS</span><br></pre></td></tr></table></figure>

<p>将</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Try Lubuntu <span class="keyword">without</span> installing</span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Try Lubuntu <span class="keyword">without</span> installing-KXS</span><br></pre></td></tr></table></figure>

<p>修改 txt.cfg 文件（menu label 一行最后的“-KXS”为新加字符串）：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">default live</span><br><span class="line"><span class="selector-tag">label</span> live</span><br><span class="line">  <span class="selector-tag">menu</span> <span class="selector-tag">label</span> ^Try Lubuntu without installing-KXS</span><br><span class="line">  kernel /casper/vmlinuz.efi</span><br><span class="line">  append  file=/cdrom/preseed/lubuntu<span class="selector-class">.seed</span> boot=casper initrd=/casper/initrd<span class="selector-class">.lz</span> quiet splash ---</span><br><span class="line"><span class="selector-tag">label</span> live-install</span><br><span class="line">  <span class="selector-tag">menu</span> <span class="selector-tag">label</span> ^Install Lubuntu-KXS</span><br><span class="line">  kernel /casper/vmlinuz.efi</span><br><span class="line">  append  file=/cdrom/preseed/lubuntu<span class="selector-class">.seed</span> boot=casper only-ubiquity initrd=/casper/initrd<span class="selector-class">.lz</span> quiet splash ---</span><br><span class="line"><span class="selector-tag">label</span> check</span><br></pre></td></tr></table></figure>

<p>zh_CN.tr 文件中，将</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">试用 Lubuntu 而不安装</span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">试用 Lubuntu 而不安装-人生</span><br></pre></td></tr></table></figure>

<p>将</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安装 Lubuntu</span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安装 Lubuntu-何处</span><br></pre></td></tr></table></figure>

<p>zh_TW.tr 文件中，将</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在不需安裝的情況下試用 Lubuntu</span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在不需安裝的情況下試用 Lubuntu-天涯</span><br></pre></td></tr></table></figure>

<p>将</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安裝 Lubuntu</span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安裝 Lubuntu-行客</span><br></pre></td></tr></table></figure>

<p>效果如下（红框部分所示）：<br>英文界面：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_bootlogo_en.png">

<p>简体中文界面：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_bootlogo_zh.png">

<p>繁体中文界面：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_bootlogo_tw.png">

<p>从图中看到，繁体中文效果不佳，原因未知，个人猜测和文字长度或者编码格式有关。<br>另外在测试中发现，即使是简体中文，如果字符串长度太长，也会显示不正常。</p>
<h2 id="4-4-修改终端效果"><a href="#4-4-修改终端效果" class="headerlink" title="4.4 修改终端效果"></a>4.4 修改终端效果</h2><p>lubuntu 使用的终端是 lxterminal，其配置文件目录为：<br>/usr/share/lxterminal/<br>配置文件为（如终端默认字体、字体大小）：<br>/usr/share/lxterminal/lxterminal.conf<br>修改该文件即可对 lxterminal 进行定制，修改示例：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[general]</span></span><br><span class="line"><span class="attr">fontname</span>=Ubuntu Mo<span class="literal">no</span> <span class="number">11</span></span><br><span class="line"><span class="attr">selchars</span>=-A-Za-z0-<span class="number">9</span>,./?%&amp;<span class="comment">#:_</span></span><br><span class="line"><span class="attr">scrollback</span>=<span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>修改的是 fontname 这一行。<br>说明：这是修改 GUI 的终端配置（字体选择和字体大小）。效果如下图红框所示。  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_lxterminal.png">

<p>说明：默认为 Monospace 10，现改为 Monospace 11。</p>
<h2 id="4-5-修改鼠标样式"><a href="#4-5-修改鼠标样式" class="headerlink" title="4.5 修改鼠标样式"></a>4.5 修改鼠标样式</h2><p>使用 chroot 进入 squashfs-root 目录。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm <span class="regexp">/etc/</span>alternatives/x-cursor-theme</span><br><span class="line">ln -s <span class="regexp">/usr/</span>share<span class="regexp">/icons/</span>DMZ-Black<span class="regexp">/cursor.theme /</span>etc<span class="regexp">/alternatives/</span>x-cursor-theme</span><br></pre></td></tr></table></figure>

<p>此方法修改无效果，请参考下文。笔者认为理论上应该修改正确了，但却不生效，原因待查。</p>
<h2 id="4-6-修改桌面图标"><a href="#4-6-修改桌面图标" class="headerlink" title="4.6 修改桌面图标"></a>4.6 修改桌面图标</h2><p>lubuntu 的桌面图标配置文件目录是：squashfs-root/usr/share/applications/，配置文件以.desktop 结尾。<br>默认情况下启动，桌面会有安装系统的图标。下面修改图标的显示文字。<br>修改文件：squashfs-root/usr/share/applications/ubiquity.desktop<br>将</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安裝 <span class="keyword">RELEASE</span></span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安装我的！系统！ <span class="keyword">RELEASE</span></span><br></pre></td></tr></table></figure>

<p>也可以修改为其它想显示的字符。重新制作 ISO，启动 ISO 后，桌面出现效果如下：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_desktop_install.png">

<p>说明：通过修改配置文件，可以定制桌面图标显示的文字。</p>
<h2 id="4-7-放置图标快捷到桌面"><a href="#4-7-放置图标快捷到桌面" class="headerlink" title="4.7 放置图标快捷到桌面"></a>4.7 放置图标快捷到桌面</h2><p>为了方便在桌面直接双击打开程序，需要放程序图标放到桌面上。<br>使用 chroot 进入 squashfs-root 目录。<br>创建/etc/skel/Desktop 目录，将需要显示到桌面的图标文件拷贝到该目录。下面将 firefox 和终端快捷方式放到桌面：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p <span class="regexp">/etc/</span>skel/Desktop</span><br><span class="line">cd <span class="regexp">/etc/</span>skel<span class="regexp">/Desktop/</span></span><br><span class="line">cp <span class="regexp">/usr/</span>share<span class="regexp">/applications/</span>firefox.desktop .</span><br><span class="line">cp <span class="regexp">/usr/</span>share<span class="regexp">/applications/</span>lxterminal.desktop .</span><br><span class="line">chmod +x *</span><br></pre></td></tr></table></figure>

<p>效果如下：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_desktop_icon.png">
<p>说明：此方式适用于默认 lubuntu 用户的情况。（注意和以下方式有区别，如果使用自添加用户的话，则本节设置方法无效）<br>知识点：<br>/etc/skel/是新加用户时，该用户拥有的设置，系统启动时，会创建 lubuntu 用户，则这个目录的内容将会拷贝到 lubuntu 的 home 目录。</p>
<h2 id="4-8-新加-home-目录和根目录到桌面"><a href="#4-8-新加-home-目录和根目录到桌面" class="headerlink" title="4.8 新加 home 目录和根目录到桌面"></a>4.8 新加 home 目录和根目录到桌面</h2><p>默认情况下，桌面是没有 home 目录和根目录的图标的。<br>根据《放置图标快捷到桌面》一节的启示，只要找到 home 目录的图标配置文件，将其放到/etc/skel/Desktop/，就能在桌面显示了。<br>lubuntu 文件系统管理使用 pcmanfm 工具，其桌面配置文件为：<br>/usr/share/applications/pcmanfm.desktop<br>将该文件拷贝一份，重命名为 pcmanfm_home.desktop（表示是 home 目录），要修改的内容如下（下面的内容已修改）：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Icon</span>=system-file-manager <span class="comment"># 在桌面上的图案名称（需要搜索目录以确认要添加的图标名）</span></span><br><span class="line"><span class="attr">Name</span>=Home <span class="comment"># 显示的图标名（英文系统显示图标名称）</span></span><br><span class="line"><span class="attr">Name[zh_CN]</span>=家目录 <span class="comment"># 中文系统图标名</span></span><br><span class="line"><span class="attr">Name[zh_TW]</span>=家目录 <span class="comment"># 繁体系统图标名</span></span><br><span class="line"><span class="attr">Exec</span>=pcmanfm %U <span class="comment"># 要执行的命名，注：%U表示本次登陆的用户的home目录</span></span><br></pre></td></tr></table></figure>

<p>再重新拷贝一份，重命名为 pcmanfm_rootfs.desktop（表示是根目录），要修改的内容如下（下面的内容已修改）：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Icon</span>=system-file-manager</span><br><span class="line"><span class="attribute">Name</span>=File System</span><br><span class="line">Name[zh_CN]=根目录</span><br><span class="line">Name[zh_TW]=根目录</span><br><span class="line"><span class="attribute">Exec</span>=pcmanfm /</span><br></pre></td></tr></table></figure>

<p>内容注释参考前面，不再赘述。</p>
<p>效果如下图所示：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_desktop_home.png">
<p>（注：左为中文，右为英文，可以看到两者图标间距不同，猜测是字符编码原因，也可能是笔者截图导致的视觉误差。）</p>
<h2 id="4-9-新加锁屏"><a href="#4-9-新加锁屏" class="headerlink" title="4.9 新加锁屏"></a>4.9 新加锁屏</h2><p>lubuntu 默认使用 lxlock 作为锁屏工具。这里使用另一种锁屏方案：xlock。xlock 官网为：<a href="http://www.sillycycle.com/xlockmore.html" target="_blank" rel="noopener">http://www.sillycycle.com/xlockmore.html</a>，源码下载地址为：<a href="http://www.sillycycle.com/xlock/" target="_blank" rel="noopener">http://www.sillycycle.com/xlock/</a>。<br>但是，笔者没有编译通过。限于时间，就直接使用 livecd 里面的 xlock 来实现。<br>实现方法：<br>1、将 livecd 的 xlock 和 xlockless 拷贝出来，再拷贝到/usr/bin 目录，并修改其权限为 777。<br>2、添加桌面图标文件 xlock.desktop（参考/usr/share/applications/lubuntu-screenlock.desktop 文件进行修改），内容如下：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Desktop Entry]</span></span><br><span class="line"><span class="attr">Icon</span>=system-lock-screen</span><br><span class="line"><span class="attr">Exec</span>=lxlockless</span><br><span class="line"><span class="attr">Type</span>=Application</span><br><span class="line"><span class="attr">Categories</span>=GTK<span class="comment">;System;Utility;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Name</span>=ScreenLock</span><br><span class="line"><span class="attr">Name[zh_CN]</span>=锁屏</span><br><span class="line"><span class="attr">Name[zh_TW]</span>=锁屏</span><br></pre></td></tr></table></figure>

<p>注：Categories 项的内容决定于图标显示在启动菜单的位置。Name 为显示的名字（不同国家语言，显示的名字不同）<br>3、将 xlock.desktop 拷贝到/etc/skel/Desktop 目录<br>4、安装缺少的工具：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="builtin-name">get</span> install -y rxvt-unicode</span><br></pre></td></tr></table></figure>

<p>5、由于 xlock 不是在本地编译的，其使用的链接器文件为/lib/ld-linux-x86-64.so.2，而 x64 平台的链接器为/lib64/ld-linux-x86-64.so.2，因此需要额外拷贝一份，命令如下：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /lib64/ld-linux-x86-<span class="number">64</span>.so.<span class="number">2</span> /<span class="class"><span class="keyword">lib</span>/</span></span><br></pre></td></tr></table></figure>

<p>重启制作 ISO，启动，在桌面上会看到锁屏图标，双击，然后输入 2 次相同的密码，就会锁屏（此时屏幕是黑色的）。按任意键后，在出现的界面中输入刚才的密码，即能解锁。效果图如下：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_xlock.png">

<h2 id="4-10-启动菜单添加新图标"><a href="#4-10-启动菜单添加新图标" class="headerlink" title="4.10 启动菜单添加新图标"></a>4.10 启动菜单添加新图标</h2><p>在桌面左下角启动菜单新加项目，不需要修改 panel 相关文件。以新加的锁屏功能放到 System Tools 分类为例，在.desktop 文件中关键的语句为：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Categories</span>=GTK<span class="comment">;System;Utility;</span></span><br></pre></td></tr></table></figure>

<p>效果图如下（左侧中文，右侧英文）：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_startmenu_xlock.png">
<p>注意，菜单中显示的图标上的文字，由.desktop 文件的 Name 决定。</p>
<h2 id="4-11-启动菜单添加新分类"><a href="#4-11-启动菜单添加新分类" class="headerlink" title="4.11 启动菜单添加新分类"></a>4.11 启动菜单添加新分类</h2><p>以安装的 vim 添加到编程分类为例进行说明。<br>用 apt-get install vim 方式安装 vim 后，会自动在/usr/share/applications 目录下创建 vim.desktop 文件。<br>将其拷贝一份，重命名为 myvim.desktop，修改 Categories，由</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Categories</span>=Utility<span class="comment">;TextEditor;</span></span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Categories</span>=Development<span class="comment">;Programming;</span></span><br></pre></td></tr></table></figure>

<p>为了与 vim.desktop 作区别，修改名称，如下：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Name</span>=MyVim</span><br><span class="line"><span class="attr">GenericName</span>=My Text Editor</span><br></pre></td></tr></table></figure>

<p>重新制作 ISO，启动后，效果图如下（左侧英文，右侧中文）  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_startmenu_pro.png">

<p>总结：不管是新安装的软件还是系统已有的软件，如果要显示在桌面或菜单，都需要添加(或修改).desktop 文件。放到桌面上，则要将.desktop 文件拷贝到 Desktop 目录，菜单分类则需要将 Categories 修改为合适的字段。至于显示的名称，则由该文件的 Name 字段确定。参考其它的.desktop 文件，进行学习了解。</p>
<h2 id="4-12-添加用户：普通用户-latelee"><a href="#4-12-添加用户：普通用户-latelee" class="headerlink" title="4.12 添加用户：普通用户 latelee"></a>4.12 添加用户：普通用户 latelee</h2><p>使用 chroot 进入 squashfs-root 目录。</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">adduser </span>latelee (回车，然后输入<span class="number">2</span>次密码，一路回车即可)</span><br></pre></td></tr></table></figure>

<p>将用户添加 root 权限：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">addgroup </span>-system admin</span><br><span class="line"><span class="keyword">adduser </span>latelee admin</span><br></pre></td></tr></table></figure>

<p>命令说明：首先添加 admin 组，将 latelee 用户添加到 admin 组。</p>
<p>注：添加用户后，启动 ISO 时，会提示输入用户名密码，所以无法直接进入系统，是否需要此功能，三思而定。<br>登陆效果图如下：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_newuser_latelee.png">

<p>在此前提下，创建桌面快捷方式：<br>创建文件：/home/latelee/Desktop/lxterminal.desktop。Desktop 目录默认没有，需要自行创建。<br>内容如下：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Desktop Entry]</span></span><br><span class="line"><span class="attr">Type</span>=Link</span><br><span class="line"><span class="attr">Name</span>=LXTerminal</span><br><span class="line"><span class="attr">Icon</span>=lxterminal</span><br><span class="line"><span class="attr">URL</span>=/usr/share/applications/lxterminal.desktop</span><br></pre></td></tr></table></figure>

<p>启动 ISO，登陆后，桌面有图标出现。想要其它桌面图标，操作同理。桌面“快捷方式”位于/usr/share/applications/目录下。</p>
<p>说明：这个操作主要是在 ISO 光盘添加一个用户，并以该用户运行系统。如果想要默认的 lubuntu 用户，则不需要新加用户。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《TMPTMPTMPTMP</span><br><span class="line"></span><br><span class="line">/etc/lightdm/lightdm-gtk-greeter.conf.d/30_lubuntu.conf</span><br><span class="line"></span><br><span class="line">修改该文件，无效果。</span><br><span class="line">[greeter]</span><br><span class="line"><span class="attribute">logo</span>=/usr/share/icons/lubuntu/places/64/start-here.svg</span><br><span class="line"><span class="attribute">background</span>=/usr/share/lubuntu/wallpapers/lubuntu-default-wallpaper.png</span><br><span class="line"><span class="attribute">theme-name</span>=Lubuntu-default</span><br><span class="line"><span class="attribute">icon-theme-name</span>=lubuntu</span><br><span class="line"><span class="attribute">font-name</span>=Ubuntu</span><br><span class="line"><span class="attribute">xft-antialias</span>=<span class="literal">true</span></span><br><span class="line"><span class="comment">#xft-dpi=</span></span><br><span class="line"><span class="attribute">xft-hintstyle</span>=full</span><br><span class="line"><span class="attribute">xft-rgba</span>=rgb</span><br><span class="line"></span><br><span class="line">》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》TMPTMPTMPTMP</span><br></pre></td></tr></table></figure>

<h2 id="4-13-添加用户：root-用户"><a href="#4-13-添加用户：root-用户" class="headerlink" title="4.13 添加用户：root 用户"></a>4.13 添加用户：root 用户</h2><p>添加 root 密码：</p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># passwd root</span></span><br></pre></td></tr></table></figure>

<p>TODO:经尝试，不生效。原因待查。</p>
<h2 id="4-14-修改主题、鼠标样式"><a href="#4-14-修改主题、鼠标样式" class="headerlink" title="4.14 修改主题、鼠标样式"></a>4.14 修改主题、鼠标样式</h2><p>下面是一种折中的方法。最好的方案暂时未找到。<br>使用 livecd 启动，开机，用默认的 lubuntu 用户登陆，先修改好自己想要的主题、鼠标样式，设置好桌面上显示的图标，之后得到配置文件在/home/lubuntu/目录(在.config 和.icons 目录)，将这个目录做成压缩包（lubunut.tar.bz2），然后拷贝到制作 ISO 镜像的主机（建议用 scp 通过 ssh 来拷贝，快速）。<br>在主机上，将上面 lubuntu 目录压缩包（lubunut.tar.bz2）解压出来（本示例是放到 work/lubuntu 目录），拷贝到目录 squashfs-root/etc/skel/。下面是一个示例(注：下面命令的当前目录在 iso，work 目录存放一些配置文件、图片等，squashfs-root 是 iso 文件系统所在目录)。<br>拷贝主题、字体，等等：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp work<span class="regexp">/lubuntu/</span>.config<span class="regexp">/ squashfs-root/</span>etc<span class="regexp">/skel/</span> -a</span><br></pre></td></tr></table></figure>

<p>拷贝鼠标样式：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -a work<span class="regexp">/lubuntu/</span>.icons<span class="regexp">/ squashfs-root/</span>etc<span class="regexp">/skel/</span></span><br></pre></td></tr></table></figure>

<p>拷贝桌面图标：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -a work<span class="regexp">/lubuntu/</span>Desktop<span class="regexp">/ squashfs-root/</span>etc<span class="regexp">/skel/</span></span><br></pre></td></tr></table></figure>

<p>注意，为了防止权限问题造成无法读取文件，需要执行以下命令更改权限：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">chroot</span> squashfs-root <span class="comment"># 进入chroot环境</span></span><br><span class="line"><span class="keyword">chmod</span> <span class="number">777</span> squashfs-root/etc/skel/.* -R</span><br><span class="line"><span class="keyword">exit</span> <span class="comment">#退出chroot环境。</span></span><br></pre></td></tr></table></figure>

<p>最后，制作光盘 ISO，启动新的 ISO，即可看到修改后的效果。<br>总结：<br>因为 squashfs-root/etc/skel/存放的是默认用户 lubuntu 的配置文件，因此，只要将我们想要的效果配置文件拷贝到对应的位置即可（如.config、.icons）。</p>
<p>知识点：<br>work/lubuntu/.config/gtk-3.0/settings.ini：主题、字体大小、鼠标样式<br>work/lubuntu/.config/lxsession/Lubuntu/desktop.conf：桌面配置（主题、字体大小、鼠标样式）<br>work/lubuntu/.config/lxterminal/lxterminal.conf：终端配置<br>work/lubuntu/.icons/user-dirs.dirs：里面是 home 目录的默认目录（video 等）<br>work/lubuntu/.icons/default/index.theme：主题<br>（为什么主题配置要写那么多文件，笔者也不懂&gt;_&gt;）</p>
<h2 id="4-15-修改时区"><a href="#4-15-修改时区" class="headerlink" title="4.15 修改时区"></a>4.15 修改时区</h2><p>livecd 默认是 UTC 时间，为了方便定制与实际时间对应起来，需要修改默认的时区。<br>使用 chroot 进入 squashfs-root 目录。将所需时区文件链接到/etc/localtime 文件。下面示例是设置系统时间为东八区（上海）：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm <span class="regexp">/etc/</span>localtime</span><br><span class="line">ln -s <span class="regexp">/usr/</span>share<span class="regexp">/zoneinfo/</span>Asia<span class="regexp">/Shanghai /</span>etc<span class="regexp">/localtime</span></span><br></pre></td></tr></table></figure>

<h2 id="4-16-添加环境变量"><a href="#4-16-添加环境变量" class="headerlink" title="4.16 添加环境变量"></a>4.16 添加环境变量</h2><p>使用 chroot 进入 squashfs-root 目录。<br>编辑文件/etc/bash.bashrc，在文件最后添加想要的环境变量或命令别名。比如默认是没有 ll 命令的，则可以添加：</p>
<figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alias</span> <span class="title">ll</span>=<span class="comment">'ls -alF'</span></span><br><span class="line"><span class="keyword">alias</span> <span class="title">la</span>=<span class="comment">'ls -A'</span></span><br><span class="line"><span class="keyword">alias</span> <span class="title">l</span>=<span class="comment">'ls -CF'</span></span><br></pre></td></tr></table></figure>

<p>测试：即时生效：source /etc/bash.bashrc，然后输入 ll 即可看到生效了。</p>
<p>说明：修改这个文件，主要是方便定制一些命令。如果没有这方面的需要，则不用理会。</p>
<h2 id="4-17-系统汉化"><a href="#4-17-系统汉化" class="headerlink" title="4.17 系统汉化"></a>4.17 系统汉化</h2><p>lubuntu 默认情况下已经有部分界面汉化了，但不完整。系统的汉化需要对应语言包的支持（需要哪种语言则安装哪个语言支持包）。本节安装的是简体中文、繁体中文。语言包由世界各国志愿者维护（即每种语言，都需要人工进行翻译，放到 mo 或 po 文件里面）。<br>使用 chroot 进入 squashfs-root，安装简体中文语言支持包：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get <span class="keyword">install</span> -y <span class="keyword">language</span>-pack-zh-hans <span class="keyword">language</span>-pack-gnome-zh-hans</span><br></pre></td></tr></table></figure>

<p>繁体中文支持包：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get <span class="keyword">install</span> -y <span class="keyword">language</span>-pack-zh-hant <span class="keyword">language</span>-pack-gnome-zh-hant</span><br></pre></td></tr></table></figure>

<p>英文包（注：默认已经安装了，所以会提示“升级”而不是安装）</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> install -<span class="keyword">y</span> <span class="keyword">language</span>-pack-<span class="keyword">en</span> <span class="keyword">language</span>-pack-gnome-<span class="keyword">en</span></span><br></pre></td></tr></table></figure>

<p>下面对比原版和定制版本的效果：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_i18n.png">

<p>从图中看到，有部分已经进行了汉化，但有部分依然没有被汉化。根据网络为数不多的资料猜测，应该是语言包并没有全部翻译造成的。如果要完全汉化，只能通过修改语言包文件达到目的，虽然 4.18 小节讲述了语言文件的修改方法，但整体而言，语言包的翻译是一个大工程，已超过本文范围了，故不再深入讲解。</p>
<h2 id="4-18-语言文件修改"><a href="#4-18-语言文件修改" class="headerlink" title="4.18 语言文件修改"></a>4.18 语言文件修改</h2><p>前面安装的语言包，实际上将 mo 文件放到合适的位置。不同语言，“合适的位置”也不同。<br>简体中文的 mo 文件位置：/usr/share/locale/zh_CN/LC_MESSAGES/<br>繁体中文：/usr/share/locale/zh_TW/LC_MESSAGES/<br>英文系统：/usr/share/locale/en/LC_MESSAGES/（注：似乎英文是天然支持的，因此该目录下的 mo 文件并不多。）<br>mo 文件是二进制文件，无法直接修改，需要将其转换成 po 文件，修改 po 文件，再将其转成 mo，这样才能完成更新的操作。<br>下面是文件系统管理器 pcmanfm 的语言文件为例说明。<br>找到/usr/share/locale/zh_CN/LC_MESSAGES/pcmanfm.mo，使用以下命令转换 po 文件：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">msgunfmt</span> <span class="selector-tag">pcmanfm</span><span class="selector-class">.mo</span> <span class="selector-tag">-o</span> <span class="selector-tag">pcmanfm</span><span class="selector-class">.po</span></span><br></pre></td></tr></table></figure>

<p>然后编辑 pcmanfm.po 文件，此处修改示例如下：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">msgid <span class="string">"translator-credits"</span></span><br><span class="line">msgstr <span class="string">"Wylmer Wang &lt;wantinghard@gmail.com&gt;\nLate Lee &lt;li@latelee.org&gt;"</span></span><br><span class="line"></span><br><span class="line">msgid <span class="string">"using LibFM ver. %s\n"</span></span><br><span class="line">msgstr <span class="string">"--我的--使用 LibFM 版本 %s\n"</span></span><br></pre></td></tr></table></figure>

<p>然后再转换成 mo 文件：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">msgfmt</span> <span class="selector-tag">pcmanfm</span><span class="selector-class">.po</span> <span class="selector-tag">-o</span> <span class="selector-tag">pcmanfm</span><span class="selector-class">.mo</span></span><br></pre></td></tr></table></figure>

<p>将重新生成的 pcmanfm.mo 拷贝到原处，制作 ISO，启动，选择简体中文。得到的效果图如下所示：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_i18n2.png">

<h2 id="4-19-添加拼音、五笔输入法"><a href="#4-19-添加拼音、五笔输入法" class="headerlink" title="4.19 添加拼音、五笔输入法"></a>4.19 添加拼音、五笔输入法</h2><p>安装 fcitx 拼音、五笔：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get <span class="keyword">update</span> <span class="comment"># 更新源</span></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> -y fcitx-pinyin fcitx-<span class="keyword">table</span>-wubi fcitx-<span class="keyword">table</span>-wbpy <span class="comment"># 依次是拼音、五笔、五笔拼音</span></span><br></pre></td></tr></table></figure>

<p>另外，网上有说法要添加以下源：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">add</span>-apt-repository <span class="keyword">pp</span><span class="variable">a:fcitx</span>-team/stable</span><br></pre></td></tr></table></figure>

<p>经测试，不添加也可以正常安装。</p>
<p>输入法选择界面：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_fcitx.png">

<p>五笔输入界面：  </p>
<img src="/solution/linux/lubuntu16-4-customize/p_fcitx2.png">

<p>fcitx 拼音、五笔在中文环境才能显示出来，英文环境无法使用。</p>
<p>注：fcitx 从源码安装十分麻烦，依赖库有十多个，详细参考以下文章：<br><a href="https://fcitx-im.org/wiki/Compile_from_source" target="_blank" rel="noopener">https://fcitx-im.org/wiki/Compile_from_source</a></p>
<h2 id="4-20-删除软件安装途径"><a href="#4-20-删除软件安装途径" class="headerlink" title="4.20 删除软件安装途径"></a>4.20 删除软件安装途径</h2><p>为防止源更新，需要删除 ISO 安装软件的途径。安装软件的途径有：apt、dpkg、新立得（synpatic）、软件中心。只要将其删除掉，则在启动 ISO 时就无法再安装软件了。</p>
<p>使用 chroot 进入 squashfs-root 目录。<br>卸载 synpatic:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="builtin-name">get</span> autoremove -y synaptic</span><br></pre></td></tr></table></figure>

<p>卸载软件中心：</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> autoremove -y lubuntu-software-<span class="built_in">center</span></span><br></pre></td></tr></table></figure>

<p>卸载 gdebi：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="builtin-name">get</span> autoremove -y gdebi gdebi-gtk</span><br></pre></td></tr></table></figure>

<p>卸载软件更新：</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> autoremove -y software-<span class="built_in">properties</span>-gtk update-manager</span><br></pre></td></tr></table></figure>

<p>删除 apt、dpkg：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf $(<span class="builtin-name">find</span> /usr -name <span class="string">"*dpkg*"</span>) $(<span class="builtin-name">find</span> /usr -name <span class="string">"*apt*"</span>)</span><br><span class="line">rm -rf $(<span class="builtin-name">find</span> /etc -name <span class="string">"*dpkg*"</span>) $(<span class="builtin-name">find</span> /etc -name <span class="string">"*apt*"</span>)</span><br></pre></td></tr></table></figure>

<p>命令解释：删除所有带“dpkg”、“apt”字样的文件。</p>
<p>注意，此操作具备一定危险，需要谨慎操作。如果不是在 chroot 环境，会将主机的 dpkg 和 apt 删除掉。三思而定。</p>
<h1 id="5、最终定制效果及-ISO-下载"><a href="#5、最终定制效果及-ISO-下载" class="headerlink" title="5、最终定制效果及 ISO 下载"></a>5、最终定制效果及 ISO 下载</h1><p>定制效果图如下：</p>
<img src="/solution/linux/lubuntu16-4-customize/p_desktop_final.png">
<p>本工程定制的 ISO 镜像下载地址如下：<br>链接: <a href="https://pan.baidu.com/s/1jJ7bRNo" target="_blank" rel="noopener">https://pan.baidu.com/s/1jJ7bRNo</a> 密码: 5c1u<br>md5sum：4ac0996167214e0b541be7016be19220</p>
<h1 id="6、免责声明"><a href="#6、免责声明" class="headerlink" title="6、免责声明"></a>6、免责声明</h1><p>本文涉及 lubuntu、ubuntu、linux 的商标(和版权)归属各自所属组织/公司。</p>
</main>

    
  </div>
</section>

<nav class="page-section text-center">
  <div class="btn-group" role="group" aria-label="Post navigator">
    
    <a class="btn btn-secondary" role="button" href="article/article-post/">
      &lt; 文章示例
    </a>
    
    <a class="btn btn-secondary" role="button" href="manual/onvif-profile-s-spec/">
      ONVIF Profile S 协议 &gt;
    </a>
    
  </div>
</nav>

<script>
(function () {

  var path = self.location.href.split('#')[0];

  $('details > .toc a[href]').attr('href', function (_, value) {

    return path + value;
  });

  $('.blog-post').find('h1, h2, h3, h4, h5, h6').append(function () {

    if ( this.id.trim() )
      return '<a class="header-link" title="Permalink" href="' +
        path + '#' + this.id +
        '"><span class="octicon octicon-link"></span></a>';
  });
})();
</script>

  <footer class="footer">
    <div class="container">
      <nav class="footer-nav">
        
          <a class="footer-nav-item active" href="/profile/license">版权声明</a>
        
          <a class="footer-nav-item " href="/profile/contact">联系我们</a>
        
          <a class="footer-nav-item " href="https://electronjs.org/">electron</a>
        
          <a class="footer-nav-item " href="https://kaiyuanshe.cn/">kaiyuanshe</a>
        
          <a class="footer-nav-item " href="http://kxs-co.gicp.net/Linux/index.html">科学社</a>
        
      </nav>
      <span>Copyright &copy; <a href="https://www.cststudio.com.cn">CST研习舍</a> 2017-2020</span>
      <a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank"> 桂ICP备10003672号-2</a>
      <script src="https://s13.cnzz.com/z_stat.php?id=1273965306&web_id=1273965306" language="JavaScript"></script>
    </div>
  </footer>
<script>if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js?t=1608624537946')
    .then(function () {console.log('ServiceWorker Register Successfully.')})
    .catch(function (e) {console.error(e)});
}
</script></body>
</html>